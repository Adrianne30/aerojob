{"ast":null,"code":"import React,{useCallback,useEffect,useState}from'react';import{Link,useLocation}from'react-router-dom';import{surveysAPI}from'../../utils/api';import{Eye,Edit3,Trash2}from'lucide-react';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const StatusBadge=_ref=>{let{status}=_ref;const active=String(status).toLowerCase()==='active';const cls=active?'text-green-700 bg-green-50 ring-1 ring-inset ring-green-200':'text-red-700 bg-red-50 ring-1 ring-inset ring-red-200';return/*#__PURE__*/_jsx(\"span\",{className:\"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium \".concat(cls),children:active?'Active':'Inactive'});};export default function SurveyList(){var _location$state;const[items,setItems]=useState([]);const[loading,setLoading]=useState(true);const location=useLocation();const load=useCallback(async()=>{setLoading(true);try{const data=await surveysAPI.list();// GET /api/surveys\nsetItems(Array.isArray(data)?data:[]);}finally{setLoading(false);}},[]);// initial fetch\nuseEffect(()=>{load();},[load]);// refetch when navigating back or when a child page asks to refresh\nuseEffect(()=>{load();},[location.key,(_location$state=location.state)===null||_location$state===void 0?void 0:_location$state.refresh,load]);// bonus: refetch when the window regains focus\nuseEffect(()=>{const onFocus=()=>load();window.addEventListener('focus',onFocus);return()=>window.removeEventListener('focus',onFocus);},[load]);if(loading)return/*#__PURE__*/_jsx(\"div\",{className:\"p-6\",children:\"Loading\\u2026\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"max-w-7xl mx-auto px-4 py-6\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center justify-between mb-4\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold flex items-center gap-3\",children:\"Surveys\"}),/*#__PURE__*/_jsx(Link,{to:\"/admin/surveys/new\",className:\"btn btn-primary\",children:\"+ New Survey\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid gap-4\",children:[items.map(s=>{var _s$questions;return/*#__PURE__*/_jsx(\"div\",{className:\"card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body flex flex-col md:flex-row md:items-center md:justify-between gap-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold\",children:s.title}),/*#__PURE__*/_jsx(StatusBadge,{status:s.status})]}),s.description&&/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-600\",children:s.description}),/*#__PURE__*/_jsxs(\"div\",{className:\"text-sm opacity-70 mt-1\",children:[\"Audience: \",String(s.audience||'').toUpperCase(),\" \\u2022\",' ',((_s$questions=s.questions)===null||_s$questions===void 0?void 0:_s$questions.length)||0,\" questions\"]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex items-center gap-3\",children:[/*#__PURE__*/_jsxs(Link,{to:\"/admin/surveys/\".concat(s._id,\"/responses\"),className:\"btn btn-outline\",children:[/*#__PURE__*/_jsx(Eye,{className:\"w-4 h-4 mr-1\"}),\" Responses\"]}),/*#__PURE__*/_jsxs(Link,{to:\"/admin/surveys/\".concat(s._id,\"/edit\"),className:\"btn btn-outline\",children:[/*#__PURE__*/_jsx(Edit3,{className:\"w-4 h-4 mr-1\"}),\" Edit\"]}),/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-ghost text-error\",onClick:async()=>{if(!window.confirm('Delete this survey?'))return;await surveysAPI.remove(s._id);load();},children:[/*#__PURE__*/_jsx(Trash2,{className:\"w-4 h-4 mr-1\"}),\" Delete\"]})]})]})},s._id);}),!items.length&&/*#__PURE__*/_jsx(\"div\",{className:\"text-center opacity-70\",children:\"No surveys yet.\"})]})]});}","map":{"version":3,"names":["React","useCallback","useEffect","useState","Link","useLocation","surveysAPI","Eye","Edit3","Trash2","jsx","_jsx","jsxs","_jsxs","StatusBadge","_ref","status","active","String","toLowerCase","cls","className","concat","children","SurveyList","_location$state","items","setItems","loading","setLoading","location","load","data","list","Array","isArray","key","state","refresh","onFocus","window","addEventListener","removeEventListener","to","map","s","_s$questions","title","description","audience","toUpperCase","questions","length","_id","onClick","confirm","remove"],"sources":["/Users/macbookair/Desktop/AeroJobs/AeroJob/frontend/src/pages/admin/SurveyList.js"],"sourcesContent":["import React, { useCallback, useEffect, useState } from 'react';\nimport { Link, useLocation } from 'react-router-dom';\nimport { surveysAPI } from '../../utils/api';\nimport { Eye, Edit3, Trash2 } from 'lucide-react';\n\nconst StatusBadge = ({ status }) => {\n  const active = String(status).toLowerCase() === 'active';\n  const cls = active\n    ? 'text-green-700 bg-green-50 ring-1 ring-inset ring-green-200'\n    : 'text-red-700 bg-red-50 ring-1 ring-inset ring-red-200';\n  return (\n    <span\n      className={`inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ${cls}`}\n    >\n      {active ? 'Active' : 'Inactive'}\n    </span>\n  );\n};\n\nexport default function SurveyList() {\n  const [items, setItems] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const location = useLocation();\n\n  const load = useCallback(async () => {\n    setLoading(true);\n    try {\n      const data = await surveysAPI.list(); // GET /api/surveys\n      setItems(Array.isArray(data) ? data : []);\n    } finally {\n      setLoading(false);\n    }\n  }, []);\n\n  // initial fetch\n  useEffect(() => {\n    load();\n  }, [load]);\n\n  // refetch when navigating back or when a child page asks to refresh\n  useEffect(() => {\n    load();\n  }, [location.key, location.state?.refresh, load]);\n\n  // bonus: refetch when the window regains focus\n  useEffect(() => {\n    const onFocus = () => load();\n    window.addEventListener('focus', onFocus);\n    return () => window.removeEventListener('focus', onFocus);\n  }, [load]);\n\n  if (loading) return <div className=\"p-6\">Loading…</div>;\n\n  return (\n    <div className=\"max-w-7xl mx-auto px-4 py-6\">\n      <div className=\"flex items-center justify-between mb-4\">\n        <h1 className=\"text-3xl font-bold flex items-center gap-3\">\n          Surveys\n        </h1>\n        <Link to=\"/admin/surveys/new\" className=\"btn btn-primary\">\n          + New Survey\n        </Link>\n      </div>\n\n      <div className=\"grid gap-4\">\n        {items.map((s) => (\n          <div key={s._id} className=\"card\">\n            <div className=\"card-body flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\n              <div>\n                <div className=\"flex items-center gap-3\">\n                  <h2 className=\"text-xl font-semibold\">{s.title}</h2>\n                  <StatusBadge status={s.status} />\n                </div>\n                {s.description && (\n                  <div className=\"text-gray-600\">{s.description}</div>\n                )}\n                <div className=\"text-sm opacity-70 mt-1\">\n                  Audience: {String(s.audience || '').toUpperCase()} •{' '}\n                  {s.questions?.length || 0} questions\n                </div>\n              </div>\n\n              <div className=\"flex items-center gap-3\">\n                <Link\n                  to={`/admin/surveys/${s._id}/responses`}\n                  className=\"btn btn-outline\"\n                >\n                  <Eye className=\"w-4 h-4 mr-1\" /> Responses\n                </Link>\n                <Link\n                  to={`/admin/surveys/${s._id}/edit`}\n                  className=\"btn btn-outline\"\n                >\n                  <Edit3 className=\"w-4 h-4 mr-1\" /> Edit\n                </Link>\n                <button\n                  className=\"btn btn-ghost text-error\"\n                  onClick={async () => {\n                    if (!window.confirm('Delete this survey?')) return;\n                    await surveysAPI.remove(s._id);\n                    load();\n                  }}\n                >\n                  <Trash2 className=\"w-4 h-4 mr-1\" /> Delete\n                </button>\n              </div>\n            </div>\n          </div>\n        ))}\n\n        {!items.length && (\n          <div className=\"text-center opacity-70\">No surveys yet.</div>\n        )}\n      </div>\n    </div>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}